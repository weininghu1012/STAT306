#Homework 6
#Question1
# A data set consists of women national track records in the year 1984 for over 50 countries: 
# variables are record times for 100m, 200m, 400m in seconds, and for 800m, 1500m, 3000m, marathon (42195m) in minutes. 
# Your data variables are: 
m100=c(11.85, 11.2, 11.79, 11.09, 11.95, 11.75, 11.45, 11.31, 11.89, 12, 11.58, 11.76, 11.29, 11.45, 11.76, 12.74, 11.73, 10.79, 11.84, 11.43, 11.73, 12.14, 11.43, 11.6, 11.96, 11.79, 11.8, 11.81, 11, 11.15, 11.13, 11.46, 12.25, 12.3, 11.95, 11.45, 12.9, 11.44, 12.23, 11.55, 11.96, 11.25, 11.16, 11.22, 11.42, 11.61, 11.01, 10.81, 11.06, 12.03, 11.41, 11.13, 11.98, 12.25) 
m200=c(24.24, 22.35, 24.05, 21.97, 24.41, 24.46, 23.06, 23.17, 23.62, 24.52, 23.31, 23.54, 23, 23.57, 25.08, 25.85, 23.88, 21.83, 24.54, 23.51, 24, 24.47, 23.09, 24, 24.6, 24.08, 23.98, 24.22, 22.13, 22.59, 22.39, 23.05, 25.07, 25, 24.28, 23.31, 27.1, 23.46, 24.21, 23.13, 24.49, 22.81, 22.82, 22.62, 23.52, 22.94, 22.39, 21.71, 22.19, 24.96, 23.04, 22.21, 24.44, 25.78) 
m400=c(55.34, 51.08, 56.05, 47.99, 54.97, 55.8, 51.5, 52.8, 53.76, 54.9, 53.12, 54.6, 52.01, 54.9, 58.1, 58.73, 52.7, 50.62, 56.09, 53.24, 53.73, 55, 50.62, 53.26, 58.25, 54.93, 53.59, 54.3, 50.46, 51.73, 50.14, 53.3, 56.96, 55.08, 53.6, 53.11, 60.4, 51.2, 55.09, 51.6, 55.7, 52.38, 51.79, 52.5, 53.6, 54.5, 49.75, 48.16, 49.19, 56.1, 52, 49.29, 56.45, 51.2) 
m800=c(2.22, 1.98, 2.24, 1.89, 2.08, 2.2, 2.01, 2.1, 2.04, 2.05, 2.03, 2.19, 1.96, 2.1, 2.27, 2.33, 2, 1.96, 2.28, 2.05, 2.09, 2.18, 1.99, 2.11, 2.21, 2.07, 2.05, 2.09, 1.98, 2, 2.03, 2.16, 2.24, 2.12, 2.1, 2.02, 2.3, 1.92, 2.19, 2.02, 2.15, 1.99, 2.02, 2.1, 2.03, 2.15, 1.95, 1.93, 1.89, 2.07, 2, 1.95, 2.15, 1.97) 
m1500=c(4.61, 4.13, 4.74, 4.14, 4.33, 4.72, 4.14, 4.49, 4.25, 4.23, 4.01, 4.6, 3.98, 4.25, 4.79, 5.81, 4.15, 3.95, 4.86, 4.11, 4.35, 4.45, 4.22, 4.35, 4.68, 4.35, 4.14, 4.16, 4.03, 4.14, 4.1, 4.58, 4.84, 4.52, 4.32, 4.07, 4.84, 3.96, 4.69, 4.18, 4.42, 4.06, 4.12, 4.38, 4.18, 4.43, 4.03, 3.96, 3.87, 4.38, 4.14, 3.99, 4.37, 4.25) 
m3000=c(10.02, 9.08, 9.89, 8.92, 9.31, 10.28, 8.98, 9.77, 9.59, 9.37, 8.53, 10.16, 8.63, 9.37, 10.9, 13.04, 9.2, 8.5, 10.54, 8.89, 9.2, 9.51, 9.34, 9.46, 10.43, 9.87, 9.02, 8.84, 8.62, 8.98, 8.92, 9.81, 10.69, 9.94, 9.98, 8.77, 11.1, 8.53, 10.46, 8.76, 9.62, 9.01, 8.84, 9.63, 8.71, 9.79, 8.59, 8.75, 8.45, 9.64, 8.88, 8.97, 9.38, 9.35) 
marathon=c(201.28, 152.37, 203.88, 158.85, 168.48, 168.45, 156.37, 168.75, 158.53, 171.38, 145.48, 200.37, 151.82, 160.48, 261.13, 306, 181.05, 142.72, 215.08, 149.38, 150.5, 191.02, 159.37, 165.42, 171.8, 182.2, 162.6, 151.2, 149.72, 155.27, 154.23, 169.98, 233, 182.77, 188.03, 153.42, 233.22, 165.45, 182.17, 145.48, 164.65, 152.48, 154.48, 177.87, 151.75, 178.52, 148.53, 157.68, 151.22, 174.68, 157.85, 160.82, 201.08, 179.17) 
country=c('indonesi', 'australi', 'domrep', 'czech', 'china', 'thailand', 'hungary', 'brazil', 'mexico', 'chile', 'norway', 'philippi', 'italy', 'israel', 'mauritiu', 'wsamoa', 'kenya', 'usa', 'guatemal', 'ireland', 'japan', 'burma', 'austria', 'columbia', 'costa', 'greece', 'spain', 'portugal', 'gbni', 'france', 'finland', 'bermuda', 'png', 'singapor', 'india', 'switzerl', 'cookis', 'rumania', 'malaysia', 'nz', 'korea', 'netherla', 'sweden', 'taipei', 'denmark', 'argentin', 'frg', 'gdr', 'ussr', 'luxembou', 'belgium', 'poland', 'turkey', 'dprkorea') 

# Create a dataframe
track=data.frame(m100,m200,m400,m800,m1500,m3000,marathon) 

# Create the velocity matrix
# Unit as second
vm100 = 100/m100
vm200 = 200/m200
vm400 = 400/m400

# Unit as minute
vm800 = (800/m800)/60
vm1500 = (1500/m1500)/60
vm3000 = (3000/m3000)/60
vmarathon = (42195/marathon)/60

# Create a new data frame
velocity = data.frame(vm100,vm200,vm400,vm800,vm1500,vm3000,vmarathon)

#Covariance matrix of the record time
pca1 = princomp(track,cor = FALSE,scores = T)
# Correlation matrix of the record time
pca2 = princomp(track,cor = TRUE,scores = T)
#Covariance matrix for velocity
pca3 = princomp(velocity,cor = FALSE,scores = T)
# Correlation matrix for velocity
pca4 = princomp(velocity,cor = TRUE,scores = T)

summary(pca1)
# Importance of components:
#   Comp.1      Comp.2       Comp.3       Comp.4       Comp.5       Comp.6       Comp.7
# Standard deviation     30.3314271 1.992818911 0.5638062475 0.3391775815 1.189881e-01 7.652820e-02 2.899797e-02
# Proportion of Variance  0.9952131 0.004296018 0.0003438667 0.0001244471 1.531573e-05 6.335390e-06 9.096320e-07
# Cumulative Proportion   0.9952131 0.999509125 0.9998529922 0.9999774392 9.999928e-01 9.999991e-01 1.000000e+00

summary(pca2)
# Importance of components:
#   Comp.1     Comp.2     Comp.3    Comp.4      Comp.5      Comp.6     Comp.7
# Standard deviation     2.4063196 0.81234526 0.55256815 0.3571294 0.233249365 0.199984275 0.14983060
# Proportion of Variance 0.8271963 0.09427212 0.04361879 0.0182202 0.007772181 0.005713387 0.00320703
# Cumulative Proportion  0.8271963 0.92146841 0.96508720 0.9833074 0.991079583 0.996792970 1.00000000

summary(pca3)
# Importance of components:
#   Comp.1     Comp.2    Comp.3     Comp.4      Comp.5      Comp.6      Comp.7
# Standard deviation     0.9776897 0.31224301 0.2296505 0.15243416 0.084656479 0.072092948 0.057520544
# Proportion of Variance 0.8348118 0.08514751 0.0460597 0.02029323 0.006259028 0.004539124 0.002889565
# Cumulative Proportion  0.8348118 0.91995935 0.9660191 0.98631228 0.992571311 0.997110435 1.000000000

summary(pca4)
# Importance of components:
#   Comp.1     Comp.2     Comp.3    Comp.4      Comp.5      Comp.6      Comp.7
# Standard deviation     2.4148568 0.78260763 0.55531083 0.3628414 0.229032500 0.201420954 0.151464662
# Proportion of Variance 0.8330762 0.08749639 0.04405287 0.0188077 0.007493698 0.005795772 0.003277363
# Cumulative Proportion  0.8330762 0.92057259 0.96462547 0.9834332 0.990926865 0.996722637 1.000000000
load1 = pca1$loadings
load2 = pca2$loadings
load3 = pca3$loadings
load4 = pca4$loadings
